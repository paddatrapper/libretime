"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[1857],{3905:function(e,t,n){n.d(t,{Zo:function(){return c},kt:function(){return u}});var a=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=a.createContext({}),p=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},c=function(e){var t=p(e.components);return a.createElement(s.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),m=p(n),u=r,h=m["".concat(s,".").concat(u)]||m[u]||d[u]||i;return n?a.createElement(h,o(o({ref:t},c),{},{components:n})):a.createElement(h,o({ref:t},c))}));function u(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,o=new Array(i);o[0]=m;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:r,o[1]=l;for(var p=2;p<i;p++)o[p]=n[p];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},54692:function(e,t,n){var a=n(67294),r=n(39960);t.Z=function(e){var t=e.version,n=e.children;return a.createElement(r.Z,{to:"https://github.com/libretime/libretime/releases/download/"+t+"/libretime-"+t+".tar.gz"},n)}},92973:function(e,t,n){n.d(t,{ZP:function(){return p}});var a=n(83117),r=n(80102),i=(n(67294),n(3905)),o=n(54692),l=["components"],s={toc:[]};function p(e){var t=e.components,n=(0,r.Z)(e,l);return(0,i.kt)("wrapper",(0,a.Z)({},s,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"This version was released the ",(0,i.kt)("strong",null,n.date),"."),(0,i.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"Please report new issues and/or feature requests in ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/libretime/libretime/issues"},"the issue tracker"),"."),(0,i.kt)("p",{parentName:"div"},"Join our ",(0,i.kt)("a",{parentName:"p",href:"https://discourse.libretime.org/"},"discourse")," or chat with us on our ",(0,i.kt)("a",{parentName:"p",href:"https://chat.libretime.org/"},"mattermost")," if you need help and for general discussion."))),(0,i.kt)("p",null,"The full tarball for the ",(0,i.kt)("code",null,n.version)," release of LibreTime is available ",(0,i.kt)(o.Z,{version:n.version,mdxType:"TarballLink"},"here"),"."))}p.isMDXComponent=!0},88717:function(e,t,n){n.r(t),n.d(t,{assets:function(){return c},contentTitle:function(){return s},default:function(){return u},frontMatter:function(){return l},metadata:function(){return p},toc:function(){return d}});var a=n(83117),r=n(80102),i=(n(67294),n(3905)),o=(n(92973),["components"]),l={title:"Unreleased"},s=void 0,p={unversionedId:"releases/unreleased",id:"releases/unreleased",title:"Unreleased",description:"--\x3e",source:"@site/../docs/releases/unreleased.md",sourceDirName:"releases",slug:"/releases/unreleased",permalink:"/docs/next/releases/unreleased",draft:!1,editUrl:"https://github.com/libretime/libretime/blob/main/docs/../docs/releases/unreleased.md",tags:[],version:"current",frontMatter:{title:"Unreleased"},sidebar:"tutorialSidebar",previous:{title:"Releases",permalink:"/docs/next/releases/"},next:{title:"LibreTime 3.0.0 alpha 12",permalink:"/docs/next/releases/3.0.0-alpha.12"}},c={},d=[{value:"\ud83d\udc96 Contributors",id:"-contributors",level:2},{value:"\ud83d\ude80 Features",id:"-features",level:2},{value:"\ud83d\udc1b Bug fixes",id:"-bug-fixes",level:2},{value:"\ud83d\udd25 Deprecation and removal",id:"-deprecation-and-removal",level:2},{value:"Allowed CORS origins configuration location",id:"allowed-cors-origins-configuration-location",level:3},{value:"\u2b06\ufe0f Upgrading",id:"\ufe0f-upgrading",level:2},{value:"Repair broken track types",id:"repair-broken-track-types",level:3},{value:"New configuration file",id:"new-configuration-file",level:3},{value:"Nginx, Apache and PHP",id:"nginx-apache-and-php",level:3},{value:"Shared files path",id:"shared-files-path",level:3},{value:"Replaced uWSGI with Gunicorn",id:"replaced-uwsgi-with-gunicorn",level:3},{value:"Logrotate config filepath",id:"logrotate-config-filepath",level:3},{value:"Worker user",id:"worker-user",level:3},{value:"LibreTime user",id:"libretime-user",level:3},{value:"New configuration schema",id:"new-configuration-schema",level:3},{value:"\u26a0\ufe0f Known issues",id:"\ufe0f-known-issues",level:2},{value:"\ud83d\udcdd Colophon",id:"-colophon",level:2}],m={toc:d};function u(e){var t=e.components,n=(0,r.Z)(e,o);return(0,i.kt)("wrapper",(0,a.Z)({},m,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h2",{id:"-contributors"},"\ud83d\udc96 Contributors"),(0,i.kt)("p",null,"The LibreTime project wants to thank the following contributors for authoring PRs to this release:"),(0,i.kt)("h2",{id:"-features"},"\ud83d\ude80 Features"),(0,i.kt)("h2",{id:"-bug-fixes"},"\ud83d\udc1b Bug fixes"),(0,i.kt)("h2",{id:"-deprecation-and-removal"},"\ud83d\udd25 Deprecation and removal"),(0,i.kt)("h3",{id:"allowed-cors-origins-configuration-location"},"Allowed CORS origins configuration location"),(0,i.kt)("p",null,"The allowed CORS origins configuration moved from the database to the configuration file. The field in the general preference form is deprecated and will be removed in the next release. Be sure to move your allowed CORS origins configuration to the ",(0,i.kt)("a",{parentName:"p",href:"/docs/next/admin-manual/setup/configuration"},"configuration file"),"."),(0,i.kt)("h2",{id:"\ufe0f-upgrading"},"\u2b06\ufe0f Upgrading"),(0,i.kt)("h3",{id:"repair-broken-track-types"},"Repair broken track types"),(0,i.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"Please run this ",(0,i.kt)("strong",{parentName:"p"},"before the upgrade procedure"),"!"))),(0,i.kt)("p",null,"The database files track type field was previously not constrained and this might have lead to files referencing a now renamed or missing track type. To preserve as much data as possible during the database migration process, you need to check whether some files have broken or missing track type references and fix them accordingly. To list broken track type references, you can run the following command:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"sudo -u libretime libretime-api dbshell --command=\"\n    SELECT f.id, f.track_type, f.track_title, f.artist_name, f.filepath\n    FROM cc_files f\n    WHERE NOT EXISTS (\n        SELECT FROM cc_track_types tt\n        WHERE tt.code = f.track_type\n    )\n    AND f.track_type IS NOT NULL\n    AND f.track_type <> '';\"\n")),(0,i.kt)("p",null,"If the above command outputs the following, no file needs fixing."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"}," id | track_type | track_title | artist_name | filepath\n----+------------+-------------+-------------+----------\n(0 rows)\n")),(0,i.kt)("h3",{id:"new-configuration-file"},"New configuration file"),(0,i.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"Please run this ",(0,i.kt)("strong",{parentName:"p"},"before the upgrade procedure"),"!"))),(0,i.kt)("p",null,"The configuration file name changed from ",(0,i.kt)("inlineCode",{parentName:"p"},"airtime.conf")," to ",(0,i.kt)("inlineCode",{parentName:"p"},"config.yml"),". Please rename your configuration file using the following command:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"sudo mv /etc/airtime/airtime.conf /etc/airtime/config.yml\n")),(0,i.kt)("p",null,"The configuration directory changed from ",(0,i.kt)("inlineCode",{parentName:"p"},"/etc/airtime")," to ",(0,i.kt)("inlineCode",{parentName:"p"},"/etc/libretime"),". Please rename your configuration directory using the following command:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"sudo mv /etc/airtime /etc/libretime\n")),(0,i.kt)("p",null,"The configuration file format changed to ",(0,i.kt)("inlineCode",{parentName:"p"},"yml"),". Please rewrite your ",(0,i.kt)("a",{parentName:"p",href:"/docs/next/admin-manual/setup/configuration"},"configuration file")," using the ",(0,i.kt)("a",{parentName:"p",href:"https://yaml.org/"},"yaml format"),". An example configuration file ",(0,i.kt)("inlineCode",{parentName:"p"},"installer/config.yml")," is present in the sources."),(0,i.kt)("h3",{id:"nginx-apache-and-php"},"Nginx, Apache and PHP"),(0,i.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"Please run this ",(0,i.kt)("strong",{parentName:"p"},"before the upgrade procedure"),"!"))),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"apache2")," web server has been replaced with ",(0,i.kt)("inlineCode",{parentName:"p"},"nginx")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"php-fpm"),", be sure to uninstall ",(0,i.kt)("inlineCode",{parentName:"p"},"apache2")," and clean related configuration files:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"sudo rm -f /etc/apache2/sites-*/{airtime,libretime}*\nsudo rm -f /etc/php/*/apache2/conf.d/{airtime,libretime}*\n\nsudo apt purge apache2 'libapache2-mod-php*'\n\nsudo rm -f /var/lib/php/sessions/sess_*\n")),(0,i.kt)("h3",{id:"shared-files-path"},"Shared files path"),(0,i.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"Please run this ",(0,i.kt)("strong",{parentName:"p"},"before the upgrade procedure"),"!"))),(0,i.kt)("p",null,"The shared files path changed from ",(0,i.kt)("inlineCode",{parentName:"p"},"/usr/share/airtime")," to ",(0,i.kt)("inlineCode",{parentName:"p"},"/usr/share/libretime"),". The directory must be renamed:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"sudo mv /usr/share/airtime /usr/share/libretime\n")),(0,i.kt)("h3",{id:"replaced-uwsgi-with-gunicorn"},"Replaced uWSGI with Gunicorn"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://uwsgi-docs.readthedocs.io"},"uWSGI")," was replaced by ",(0,i.kt)("a",{parentName:"p",href:"https://gunicorn.org/"},"Gunicorn"),", the packages and configuration file should be removed from the system:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"# Remove the configuration file\nsudo rm -f /etc/airtime/libretime-api.ini\n\n# Remove the packages\nsudo apt purge \\\n    uwsgi \\\n    uwsgi-plugin-python3\n")),(0,i.kt)("h3",{id:"logrotate-config-filepath"},"Logrotate config filepath"),(0,i.kt)("p",null,"The legacy logrotate config filepath was changed from ",(0,i.kt)("inlineCode",{parentName:"p"},"/etc/logrotate.d/airtime-php")," to ",(0,i.kt)("inlineCode",{parentName:"p"},"/etc/logrotate.d/libretime-legacy"),". The old configuration file must be removed:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"# Remove the configuration file\nsudo rm -f /etc/logrotate.d/airtime-php\n")),(0,i.kt)("h3",{id:"worker-user"},"Worker user"),(0,i.kt)("p",null,"The worker service no longer uses a dedicated ",(0,i.kt)("inlineCode",{parentName:"p"},"celery")," user to run. The old ",(0,i.kt)("inlineCode",{parentName:"p"},"celery")," user can be removed from the system:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"# Remove the celery user\nsudo deluser celery\n")),(0,i.kt)("h3",{id:"libretime-user"},"LibreTime user"),(0,i.kt)("p",null,"The LibreTime services now run using a dedicated ",(0,i.kt)("inlineCode",{parentName:"p"},"libretime")," user instead of the default ",(0,i.kt)("inlineCode",{parentName:"p"},"www-data")," user. Be sure to change the ownership of the LibreTime files:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"# Configuration directory\nsudo chown -R libretime:libretime /etc/libretime\n# Logs directory\nsudo chown -R libretime:libretime /var/log/libretime\n# Runtime directory\nsudo chown -R libretime:libretime /var/lib/libretime\n# Storage directory\nsudo chown -R libretime:libretime /srv/libretime\n")),(0,i.kt)("h3",{id:"new-configuration-schema"},"New configuration schema"),(0,i.kt)("p",null,"The configuration schema was updated."),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"general")," section has been changed:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"the\xa0",(0,i.kt)("inlineCode",{parentName:"li"},"general.protocol"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"general.base_url"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"general.base_port"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"general.base_dir")," and ",(0,i.kt)("inlineCode",{parentName:"li"},"general.force_ssl")," entries were replaced with a single ",(0,i.kt)("inlineCode",{parentName:"li"},"general.public_url")," entry, be sure to use a valid url with the new configuration entry.")),(0,i.kt)("p",null,"A new ",(0,i.kt)("inlineCode",{parentName:"p"},"storage")," section has been added:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"the ",(0,i.kt)("inlineCode",{parentName:"li"},"storage.path")," entry was added to move the storage configuration from the database to the configuration file, be sure to edit your configuration with the path to your storage. The default storage path value is ",(0,i.kt)("inlineCode",{parentName:"li"},"/srv/libretime"),".")),(0,i.kt)("h2",{id:"\ufe0f-known-issues"},"\u26a0\ufe0f Known issues"),(0,i.kt)("p",null,"The following issues may need a workaround for the time being. Please search the ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/libretime/libretime/issues"},"issues")," before reporting problems not listed below."),(0,i.kt)("h2",{id:"-colophon"},"\ud83d\udcdd Colophon"))}u.isMDXComponent=!0}}]);